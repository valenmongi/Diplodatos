
#  Segundo práctico Análisis y Visualización de Datos

Práctico de aplicación de clustering y mixturas gaussianas.

Alumnos: Ayala, Simón
         Espinosa Soriano, Francisco
         Mongi, Valentín Nicolás



#  Dataset in https://archive.ics.uci.edu/ml/datasets/Wine

set.seed(0)
data=read.table("https://archive.ics.uci.edu/ml/machine-learning-databases/wine/wine.data",sep=",")
data_sc=data


#  Funcion de normalizacion con valores maximos y minimos

normalize <- function(x) {
  return ((x-min(x))/(max(x)-min(x)))
}

#  Normalizacion de las variables, excepto las clases

data[,2:14]=lapply(data[,2:14],normalize)
data_sc[,2:14]=lapply(data_sc[,2:14],scale)

# K MEANS

k=c(1,3,5,8,11,15,18,21,25) # Vector con los distintos k a probar


```{r}
for (i in k){
  
  dataCluster=kmeans(data[,2:14],3,nstart=i)
  dataCluster_sc=kmeans(data_sc[,2:14],3,nstart=i)
  
  cat("k=",i,"\n")
  cat("\n")
  cat("Norm Max Min")
  print(table(dataCluster$cluster,data[,1]))
  cat("Norm Scale")
  print(table(dataCluster_sc$cluster,data_sc[,1]))
}
```

### Resultados clustering K

El metaparámetro K que mejor ajusta los features es 3 y bajo un proceso de normalización de los parámetros z-score. Bajo este procedimiento, se logró conservar el 96,6% de los valores de la muestra en la diagonal principal de la matriz de CrossTable.

Bajo un proceso de normalización de los parámetros siguiendo el criterio Min-Max, se obtuvo un 95,5% de los valores representados en la diagonal principal utilizando un K=15.

# Mixturas Gaussianas
library(mclust)

mcl.model <- Mclust(data[, c(1:14)], 3)
mcl.model_sc <- Mclust(data_sc[, c(1:14)], 3)


```{r}
table(mcl.model$classification,data[,1])

```
La distribución por medio del algoritmo EM arroja mejores resultados. Todos las observaciones se ubicaron en la diagonal principal. A su vez, se alcanzó un resultado más efectivo mediante un proceso de normalización min-max de las observaciones.

```{r}
table(mcl.model_sc$classification,data_sc[,1])
```
Mediante un proceso de normalización de los valores z-score, se logró posicionar al 97,7% de los valores de la muestra.


